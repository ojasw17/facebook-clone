{"ast":null,"code":"'use strict';\n\nvar align = require('wide-align');\n\nvar validate = require('aproba');\n\nvar wideTruncate = require('./wide-truncate');\n\nvar error = require('./error');\n\nvar TemplateItem = require('./template-item');\n\nfunction renderValueWithValues(values) {\n  return function (item) {\n    return renderValue(item, values);\n  };\n}\n\nvar renderTemplate = module.exports = function (width, template, values) {\n  var items = prepareItems(width, template, values);\n  var rendered = items.map(renderValueWithValues(values)).join('');\n  return align.left(wideTruncate(rendered, width), width);\n};\n\nfunction preType(item) {\n  var cappedTypeName = item.type[0].toUpperCase() + item.type.slice(1);\n  return 'pre' + cappedTypeName;\n}\n\nfunction postType(item) {\n  var cappedTypeName = item.type[0].toUpperCase() + item.type.slice(1);\n  return 'post' + cappedTypeName;\n}\n\nfunction hasPreOrPost(item, values) {\n  if (!item.type) {\n    return;\n  }\n\n  return values[preType(item)] || values[postType(item)];\n}\n\nfunction generatePreAndPost(baseItem, parentValues) {\n  var item = Object.assign({}, baseItem);\n  var values = Object.create(parentValues);\n  var template = [];\n  var pre = preType(item);\n  var post = postType(item);\n\n  if (values[pre]) {\n    template.push({\n      value: values[pre]\n    });\n    values[pre] = null;\n  }\n\n  item.minLength = null;\n  item.length = null;\n  item.maxLength = null;\n  template.push(item);\n  values[item.type] = values[item.type];\n\n  if (values[post]) {\n    template.push({\n      value: values[post]\n    });\n    values[post] = null;\n  }\n\n  return function ($1, $2, length) {\n    return renderTemplate(length, template, values);\n  };\n}\n\nfunction prepareItems(width, template, values) {\n  function cloneAndObjectify(item, index, arr) {\n    var cloned = new TemplateItem(item, width);\n    var type = cloned.type;\n\n    if (cloned.value == null) {\n      if (!(type in values)) {\n        if (cloned.default == null) {\n          throw new error.MissingTemplateValue(cloned, values);\n        } else {\n          cloned.value = cloned.default;\n        }\n      } else {\n        cloned.value = values[type];\n      }\n    }\n\n    if (cloned.value == null || cloned.value === '') {\n      return null;\n    }\n\n    cloned.index = index;\n    cloned.first = index === 0;\n    cloned.last = index === arr.length - 1;\n\n    if (hasPreOrPost(cloned, values)) {\n      cloned.value = generatePreAndPost(cloned, values);\n    }\n\n    return cloned;\n  }\n\n  var output = template.map(cloneAndObjectify).filter(function (item) {\n    return item != null;\n  });\n  var remainingSpace = width;\n  var variableCount = output.length;\n\n  function consumeSpace(length) {\n    if (length > remainingSpace) {\n      length = remainingSpace;\n    }\n\n    remainingSpace -= length;\n  }\n\n  function finishSizing(item, length) {\n    if (item.finished) {\n      throw new error.Internal('Tried to finish template item that was already finished');\n    }\n\n    if (length === Infinity) {\n      throw new error.Internal('Length of template item cannot be infinity');\n    }\n\n    if (length != null) {\n      item.length = length;\n    }\n\n    item.minLength = null;\n    item.maxLength = null;\n    --variableCount;\n    item.finished = true;\n\n    if (item.length == null) {\n      item.length = item.getBaseLength();\n    }\n\n    if (item.length == null) {\n      throw new error.Internal('Finished template items must have a length');\n    }\n\n    consumeSpace(item.getLength());\n  }\n\n  output.forEach(function (item) {\n    if (!item.kerning) {\n      return;\n    }\n\n    var prevPadRight = item.first ? 0 : output[item.index - 1].padRight;\n\n    if (!item.first && prevPadRight < item.kerning) {\n      item.padLeft = item.kerning - prevPadRight;\n    }\n\n    if (!item.last) {\n      item.padRight = item.kerning;\n    }\n  }); // Finish any that have a fixed (literal or intuited) length\n\n  output.forEach(function (item) {\n    if (item.getBaseLength() == null) {\n      return;\n    }\n\n    finishSizing(item);\n  });\n  var resized = 0;\n  var resizing;\n  var hunkSize;\n\n  do {\n    resizing = false;\n    hunkSize = Math.round(remainingSpace / variableCount);\n    output.forEach(function (item) {\n      if (item.finished) {\n        return;\n      }\n\n      if (!item.maxLength) {\n        return;\n      }\n\n      if (item.getMaxLength() < hunkSize) {\n        finishSizing(item, item.maxLength);\n        resizing = true;\n      }\n    });\n  } while (resizing && resized++ < output.length);\n\n  if (resizing) {\n    throw new error.Internal('Resize loop iterated too many times while determining maxLength');\n  }\n\n  resized = 0;\n\n  do {\n    resizing = false;\n    hunkSize = Math.round(remainingSpace / variableCount);\n    output.forEach(function (item) {\n      if (item.finished) {\n        return;\n      }\n\n      if (!item.minLength) {\n        return;\n      }\n\n      if (item.getMinLength() >= hunkSize) {\n        finishSizing(item, item.minLength);\n        resizing = true;\n      }\n    });\n  } while (resizing && resized++ < output.length);\n\n  if (resizing) {\n    throw new error.Internal('Resize loop iterated too many times while determining minLength');\n  }\n\n  hunkSize = Math.round(remainingSpace / variableCount);\n  output.forEach(function (item) {\n    if (item.finished) {\n      return;\n    }\n\n    finishSizing(item, hunkSize);\n  });\n  return output;\n}\n\nfunction renderFunction(item, values, length) {\n  validate('OON', arguments);\n\n  if (item.type) {\n    return item.value(values, values[item.type + 'Theme'] || {}, length);\n  } else {\n    return item.value(values, {}, length);\n  }\n}\n\nfunction renderValue(item, values) {\n  var length = item.getBaseLength();\n  var value = typeof item.value === 'function' ? renderFunction(item, values, length) : item.value;\n\n  if (value == null || value === '') {\n    return '';\n  }\n\n  var alignWith = align[item.align] || align.left;\n  var leftPadding = item.padLeft ? align.left('', item.padLeft) : '';\n  var rightPadding = item.padRight ? align.right('', item.padRight) : '';\n  var truncated = wideTruncate(String(value), length);\n  var aligned = alignWith(truncated, length);\n  return leftPadding + aligned + rightPadding;\n}","map":{"version":3,"sources":["C:/Users/ojaswi/Social - Media web app/frontend-react-app/node_modules/gauge/lib/render-template.js"],"names":["align","require","validate","wideTruncate","error","TemplateItem","renderValueWithValues","values","item","renderValue","renderTemplate","module","exports","width","template","items","prepareItems","rendered","map","join","left","preType","cappedTypeName","type","toUpperCase","slice","postType","hasPreOrPost","generatePreAndPost","baseItem","parentValues","Object","assign","create","pre","post","push","value","minLength","length","maxLength","$1","$2","cloneAndObjectify","index","arr","cloned","default","MissingTemplateValue","first","last","output","filter","remainingSpace","variableCount","consumeSpace","finishSizing","finished","Internal","Infinity","getBaseLength","getLength","forEach","kerning","prevPadRight","padRight","padLeft","resized","resizing","hunkSize","Math","round","getMaxLength","getMinLength","renderFunction","arguments","alignWith","leftPadding","rightPadding","right","truncated","String","aligned"],"mappings":"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","sourcesContent":["'use strict'\nvar align = require('wide-align')\nvar validate = require('aproba')\nvar wideTruncate = require('./wide-truncate')\nvar error = require('./error')\nvar TemplateItem = require('./template-item')\n\nfunction renderValueWithValues (values) {\n  return function (item) {\n    return renderValue(item, values)\n  }\n}\n\nvar renderTemplate = module.exports = function (width, template, values) {\n  var items = prepareItems(width, template, values)\n  var rendered = items.map(renderValueWithValues(values)).join('')\n  return align.left(wideTruncate(rendered, width), width)\n}\n\nfunction preType (item) {\n  var cappedTypeName = item.type[0].toUpperCase() + item.type.slice(1)\n  return 'pre' + cappedTypeName\n}\n\nfunction postType (item) {\n  var cappedTypeName = item.type[0].toUpperCase() + item.type.slice(1)\n  return 'post' + cappedTypeName\n}\n\nfunction hasPreOrPost (item, values) {\n  if (!item.type) {\n    return\n  }\n  return values[preType(item)] || values[postType(item)]\n}\n\nfunction generatePreAndPost (baseItem, parentValues) {\n  var item = Object.assign({}, baseItem)\n  var values = Object.create(parentValues)\n  var template = []\n  var pre = preType(item)\n  var post = postType(item)\n  if (values[pre]) {\n    template.push({ value: values[pre] })\n    values[pre] = null\n  }\n  item.minLength = null\n  item.length = null\n  item.maxLength = null\n  template.push(item)\n  values[item.type] = values[item.type]\n  if (values[post]) {\n    template.push({ value: values[post] })\n    values[post] = null\n  }\n  return function ($1, $2, length) {\n    return renderTemplate(length, template, values)\n  }\n}\n\nfunction prepareItems (width, template, values) {\n  function cloneAndObjectify (item, index, arr) {\n    var cloned = new TemplateItem(item, width)\n    var type = cloned.type\n    if (cloned.value == null) {\n      if (!(type in values)) {\n        if (cloned.default == null) {\n          throw new error.MissingTemplateValue(cloned, values)\n        } else {\n          cloned.value = cloned.default\n        }\n      } else {\n        cloned.value = values[type]\n      }\n    }\n    if (cloned.value == null || cloned.value === '') {\n      return null\n    }\n    cloned.index = index\n    cloned.first = index === 0\n    cloned.last = index === arr.length - 1\n    if (hasPreOrPost(cloned, values)) {\n      cloned.value = generatePreAndPost(cloned, values)\n    }\n    return cloned\n  }\n\n  var output = template.map(cloneAndObjectify).filter(function (item) {\n    return item != null\n  })\n\n  var remainingSpace = width\n  var variableCount = output.length\n\n  function consumeSpace (length) {\n    if (length > remainingSpace) {\n      length = remainingSpace\n    }\n    remainingSpace -= length\n  }\n\n  function finishSizing (item, length) {\n    if (item.finished) {\n      throw new error.Internal('Tried to finish template item that was already finished')\n    }\n    if (length === Infinity) {\n      throw new error.Internal('Length of template item cannot be infinity')\n    }\n    if (length != null) {\n      item.length = length\n    }\n    item.minLength = null\n    item.maxLength = null\n    --variableCount\n    item.finished = true\n    if (item.length == null) {\n      item.length = item.getBaseLength()\n    }\n    if (item.length == null) {\n      throw new error.Internal('Finished template items must have a length')\n    }\n    consumeSpace(item.getLength())\n  }\n\n  output.forEach(function (item) {\n    if (!item.kerning) {\n      return\n    }\n    var prevPadRight = item.first ? 0 : output[item.index - 1].padRight\n    if (!item.first && prevPadRight < item.kerning) {\n      item.padLeft = item.kerning - prevPadRight\n    }\n    if (!item.last) {\n      item.padRight = item.kerning\n    }\n  })\n\n  // Finish any that have a fixed (literal or intuited) length\n  output.forEach(function (item) {\n    if (item.getBaseLength() == null) {\n      return\n    }\n    finishSizing(item)\n  })\n\n  var resized = 0\n  var resizing\n  var hunkSize\n  do {\n    resizing = false\n    hunkSize = Math.round(remainingSpace / variableCount)\n    output.forEach(function (item) {\n      if (item.finished) {\n        return\n      }\n      if (!item.maxLength) {\n        return\n      }\n      if (item.getMaxLength() < hunkSize) {\n        finishSizing(item, item.maxLength)\n        resizing = true\n      }\n    })\n  } while (resizing && resized++ < output.length)\n  if (resizing) {\n    throw new error.Internal('Resize loop iterated too many times while determining maxLength')\n  }\n\n  resized = 0\n  do {\n    resizing = false\n    hunkSize = Math.round(remainingSpace / variableCount)\n    output.forEach(function (item) {\n      if (item.finished) {\n        return\n      }\n      if (!item.minLength) {\n        return\n      }\n      if (item.getMinLength() >= hunkSize) {\n        finishSizing(item, item.minLength)\n        resizing = true\n      }\n    })\n  } while (resizing && resized++ < output.length)\n  if (resizing) {\n    throw new error.Internal('Resize loop iterated too many times while determining minLength')\n  }\n\n  hunkSize = Math.round(remainingSpace / variableCount)\n  output.forEach(function (item) {\n    if (item.finished) {\n      return\n    }\n    finishSizing(item, hunkSize)\n  })\n\n  return output\n}\n\nfunction renderFunction (item, values, length) {\n  validate('OON', arguments)\n  if (item.type) {\n    return item.value(values, values[item.type + 'Theme'] || {}, length)\n  } else {\n    return item.value(values, {}, length)\n  }\n}\n\nfunction renderValue (item, values) {\n  var length = item.getBaseLength()\n  var value = typeof item.value === 'function' ? renderFunction(item, values, length) : item.value\n  if (value == null || value === '') {\n    return ''\n  }\n  var alignWith = align[item.align] || align.left\n  var leftPadding = item.padLeft ? align.left('', item.padLeft) : ''\n  var rightPadding = item.padRight ? align.right('', item.padRight) : ''\n  var truncated = wideTruncate(String(value), length)\n  var aligned = alignWith(truncated, length)\n  return leftPadding + aligned + rightPadding\n}\n"]},"metadata":{},"sourceType":"script"}